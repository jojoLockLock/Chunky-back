webpackJsonp([1],{253:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,'.chat-box___36Ffp{min-height:440px;width:100%;height:100%;background-color:#f7f7f7;position:relative;border:1px solid #f1f4f3;font-family:Microsoft YaHei,sans-serif}.chat-box___36Ffp .chat-title___vffIm{width:100%;height:30px;line-height:30px;text-indent:1em}.chat-box___36Ffp .chat-panel___2UOJC{width:100%;position:absolute;top:30px;left:0;bottom:20%;background-color:#fff;overflow-Y:scroll;overflow-X:hidden}.chat-box___36Ffp .chat-input-wrap___3fIh1{position:absolute;left:0;top:80%;bottom:0;right:0;background-color:#f7f7f7}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7{height:calc(100% - 25px);width:100%;resize:none;border:none;background-color:transparent;padding:10px}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7:focus,.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7:hover{outline:none;box-shadow:none}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-button___3FMsW{float:right;margin-right:4px}.chat-box___36Ffp .chat-message___hIeE5{padding:10px;overflow:hidden}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content___18ZG9{padding:5px 10px;position:relative;cursor:pointer;display:table-cell;max-width:60%;table-layout:fixed;word-wrap:break-word}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj{color:#919191;background:#e9e9e9;border-color:#e9e9e9;float:left;margin-left:10px;border-radius:0 10px 0 0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66{color:#00a2ae;background:#cfedf0;border-color:#cfedf0;float:right;margin-right:10px;border-radius:10px 0 0 0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:before,.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:before{z-index:11;position:absolute;width:0;height:0;bottom:0;border:10px solid transparent;content:""}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:before{left:-10px;border-bottom-color:#e9e9e9}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:before{right:-10px;border-bottom-color:#cfedf0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:hover{background-color:hsla(0,0%,91%,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:hover:before{border-bottom-color:hsla(0,0%,91%,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:hover{background-color:rgba(207,237,240,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:hover:before{border-bottom-color:rgba(207,237,240,.8)}',""]),t.locals={"chat-box":"chat-box___36Ffp","chat-title":"chat-title___vffIm","chat-panel":"chat-panel___2UOJC","chat-input-wrap":"chat-input-wrap___3fIh1","chat-input":"chat-input___2fNR7","chat-button":"chat-button___3FMsW","chat-message":"chat-message___hIeE5","chat-message-content":"chat-message-content___18ZG9","chat-message-content-left":"chat-message-content-left___1nJpj","chat-message-content-right":"chat-message-content-right___18Y66"}},255:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,'.side-bar___pyzdK{padding:30px 0;width:100%;height:100%;background-color:#f7f7f7;border:1px solid hsla(0,0%,91%,.8);list-style:none}.side-bar-item___3y7Sh{cursor:pointer;text-indent:2em;padding:5px;position:relative;background:transparent}.side-bar-item___3y7Sh .item-content___2Dhao{position:relative;z-index:11;color:#919191}.side-bar___pyzdK .active___24oVN{position:relative;text-indent:2em;padding:5px;background:-webkit-linear-gradient(left,#fff 10px,transparent);background:linear-gradient(90deg,#fff 10px,transparent)}.side-bar___pyzdK .active___24oVN .item-content___2Dhao{color:#00a2ae}.side-bar___pyzdK .active___24oVN:before{z-index:10;content:"";position:absolute;top:0;bottom:0;left:0;width:6px;background:#00a2ae;opacity:.5}',""]),t.locals={"side-bar":"side-bar___pyzdK","side-bar-item":"side-bar-item___3y7Sh","item-content":"item-content___2Dhao",active:"active___24oVN"}},256:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,".vertical-projection___3IWwX{box-shadow:0 0 20px hsla(0,0%,80%,.8)}.app-home___3d9MN{background-color:#fff}",""]),t.locals={"vertical-projection":"vertical-projection___3IWwX","app-home":"app-home___3d9MN"}},273:function(e,t,a){var n=a(253);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},275:function(e,t,a){var n=a(255);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},277:function(e,t,a){var n=a(256);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},510:function(e,t,a){"use strict";a(23),a(98)},525:510,571:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=(a(142),a(141)),s=n(o),l=(a(220),a(219)),r=n(l),c=a(90),i=n(c),d=a(14),f=n(d),u=a(67),_=n(u),h=a(16),p=n(h),m=a(15),g=n(m),b=a(12),x=n(b),v=a(1),y=n(v),k=a(273),E=n(k),w=a(9),N=n(w),C=a(40),I=n(C),M=a(19),F=n(M),A=function(e){var t,a=e.className,n=e.onChangeHandle,o=e.sendHandle,s=e.children,l=e.text,r=e.title,c=e.isAnimate,i=void 0===c||c,d=(0,N.default)((t={},(0,x.default)(t,a,a||!1),(0,x.default)(t,E.default["chat-box"],!0),t));return y.default.createElement("div",{className:d},y.default.createElement(O,null,r),y.default.createElement(P,{isAnimate:i},s),y.default.createElement(j,{onChangeHandle:n,sendHandle:o,value:l}))},T=y.default.PropTypes;A.propTypes={className:T.string,isAnimate:T.bool,onChangeHandle:T.func,sendHandle:T.func,text:T.string,title:T.oneOfType([T.string,T.node,T.element,T.number])};var O=function(e){var t=e.children,a=(0,N.default)((0,x.default)({},E.default["chat-title"],!0));return y.default.createElement("div",{className:a},t)},P=function(e){function t(e){(0,f.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.componentDidMount=function(){a.scrollChatPanelToBottom()},a.componentDidUpdate=function(){a.scrollChatPanelToBottom()},a.scrollChatPanelToBottom=function(){var e=F.default.findDOMNode(a.refs.chatPanel);setTimeout(function(){e.scrollTop=e.scrollHeight},0)},a.getNextMessageType=function(){var e=a.props.children;return 0==e.length?"right":e[e.length-1].props.type||"left"},a.chatPanel=null,a}return(0,g.default)(t,e),(0,_.default)(t,[{key:"render",value:function(){var e=(0,N.default)((0,x.default)({},E.default["chat-panel"],!0)),t=this.props.isAnimate;return t?y.default.createElement(I.default,{className:e,type:this.getNextMessageType(),component:"div",ref:"chatPanel"},this.props.children):y.default.createElement("div",{className:e,type:this.getNextMessageType(),ref:"chatPanel"},this.props.children)}}]),t}(y.default.Component),S=function(e){function t(e){return(0,f.default)(this,t),(0,p.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,g.default)(t,e),(0,_.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.type,n=void 0===a?"left":a,o=t.children,s=(0,N.default)((0,x.default)({},E.default["chat-message"],!0)),l=(0,N.default)((e={},(0,x.default)(e,E.default["chat-message-content"],!0),(0,x.default)(e,E.default["chat-message-content-right"],"right"==n),(0,x.default)(e,E.default["chat-message-content-left"],"left"==n),e));return y.default.createElement("div",{className:s},y.default.createElement("p",{className:l},o," "))}}]),t}(y.default.Component),j=function(e){var t=e.onChangeHandle,a=e.sendHandle,n=e.value,o=(0,N.default)((0,x.default)({},E.default["chat-input-wrap"],!0));return y.default.createElement("div",{className:o},y.default.createElement(r.default,{type:"textarea",value:n,onChange:t,className:E.default["chat-input"],onPressEnter:a}),y.default.createElement(s.default,{className:E.default["chat-button"],type:"primary",onClick:a,size:"small"},"发送"))};A.ChatMessage=S,t.default=A,e.exports=t.default},573:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(12),s=n(o),l=a(6),r=n(l),c=a(1),i=n(c),d=a(275),f=n(d),u=a(9),_=n(u),h=a(40),p=(n(h),a(19)),m=(n(p),function(e){var t=e.children,a=e.activeKey;return i.default.createElement("ul",{className:f.default["side-bar"]},t.map(function(e,t){var n=e.props;return a.indexOf(e.key)!=-1&&(n=(0,r.default)({},n,{isActive:!0})),i.default.createElement(b,(0,r.default)({},n,{key:e.key}))}))}),g=i.default.PropTypes;m.propTypes={activeKey:g.arrayOf(g.string)};var b=function(e){var t,a=e.children,n=e.isActive,o=(0,_.default)((t={},(0,s.default)(t,f.default.active,n),(0,s.default)(t,f.default["side-bar-item"],!0),t));return i.default.createElement("li",{className:o},i.default.createElement("span",{className:f.default["item-content"]},a))};m.Item=b,t.default=m,e.exports=t.default},578:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=(a(525),a(221)),s=n(o),l=(a(510),a(214)),r=n(l),c=(a(88),a(87)),i=n(c),d=a(144),f=n(d),u=a(90),_=n(u),h=a(14),p=n(h),m=a(67),g=n(m),b=a(16),x=n(b),v=a(15),y=n(v),k=a(1),E=n(k),w=a(71),N=(a(72),a(40)),C=n(N),I=a(277),M=n(I),F=a(571),A=n(F),T=a(573),O=n(T),P=a(240),S=a(93),j=A.default.ChatMessage,D=O.default.Item,H=function(e){function t(e){(0,p.default)(this,t);var a=(0,x.default)(this,(t.__proto__||(0,_.default)(t)).call(this,e));return a.componentDidMount=function(){a.linkToSocket()},a.componentWillUnmount=function(){a.socket.onclose=null,a.closeLink()},a.componentWillReceiveProps=function(e){},a.shouldComponentUpdate=function(e){return e.log.isLogin},a.messageOnChange=function(e){a.setState({text:e.target.value})},a.sendMessage=function(e){var t=a.state,n=t.text,o=t.messages,s=t.isConnect;if(""!=n){if(s===!0){o.push({content:n,type:"right"});var l=a.props.log.loginData.addressList,r=void 0===l?[]:l,c=r[0];a.socket.send((0,f.default)({type:"boardCast",content:n,targetAccount:c.userAccount}))}else i.default.error("socket未连接",S.GLOBAL_MSG_DURATION);setTimeout(function(){a.setState({text:"",messages:o})},0)}},a.linkToSocket=function(){var e=new WebSocket(P.socketHost);a.socket=e;try{e.onopen=function(){var t=a.props.log.loginData,n=t.token,o=t.userAccount;e.send((0,f.default)({type:"auth",userAccount:o,token:n})),a.setState({isConnect:!0}),i.default.info("连接成功",3)},e.onmessage=function(e){var t=(a.props.log.loginData.userAccount,a.state.messages);try{var n=JSON.parse(e.data),o=n.type;switch(o){case"newMessage":t.push({type:"left",content:n.content}),a.setState({messages:t});break;default:i.default.info(e.data,3)}}catch(e){i.default.error(e.message,3)}},e.onclose=function(){a.setState({isConnect:!1}),i.default.warn("连接已关闭",S.GLOBAL_MSG_DURATION)}}catch(e){i.default.error(e,3)}window.addEventListener?window.addEventListener("beforeunload",a.closeLink):window.attachEvent("onbeforeunload",a.closeLink)},a.closeLink=function(){var e=a.socket;try{e.close(),e=null}catch(e){new Error(e)}},a.state={text:"",isConnect:!1,messages:[]},a}return(0,y.default)(t,e),(0,g.default)(t,[{key:"render",value:function(){var e=this.state,t=e.messages,a=(e.isConnect,this.props.log.loginData.addressList),n=void 0===a?[]:a,o=n[0];return E.default.createElement(C.default,{duration:800,animConfig:{opacity:[1,0],translateY:[0,100]}},E.default.createElement("div",{className:M.default["app-home"],key:"home"},E.default.createElement(s.default,{style:{width:"500px"},className:M.default["vertical-projection"]},E.default.createElement(r.default,{span:6,style:{height:"500px"}},E.default.createElement(O.default,{activeKey:["address"+o.userAccount]},n.map(function(e){return E.default.createElement(D,{key:"address"+e.userAccount},e.userName)}))),E.default.createElement(r.default,{span:18,style:{height:"500px"}},E.default.createElement(A.default,{onChangeHandle:this.messageOnChange,sendHandle:this.sendMessage,text:this.state.text,title:E.default.createElement("p",{style:{textAlign:"center"}},"Chat with "+(o?o.userName:"= ="))},t.map(function(e,t){return E.default.createElement(j,{type:e.type,key:"message"+t},e.content)}))))))}}]),t}(E.default.Component),L=function(e){var t=e.log,a=e.message;return console.info(e.loading.models.log),{loading:e.loading.models.log,log:t,message:a}};t.default=(0,w.connect)(L)(H),e.exports=t.default}});