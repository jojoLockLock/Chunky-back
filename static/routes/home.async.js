webpackJsonp([1],{255:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,'.chat-box___36Ffp{min-height:440px;width:100%;height:100%;background-color:#f7f7f7;position:relative;border:1px solid #f1f4f3;font-family:Microsoft YaHei,sans-serif}.chat-box___36Ffp .chat-title___vffIm{width:100%;height:30px;line-height:30px;text-indent:1em}.chat-box___36Ffp .chat-panel___2UOJC{width:100%;position:absolute;top:30px;left:0;bottom:20%;background-color:#fff;overflow-Y:scroll;overflow-X:hidden}.chat-box___36Ffp .chat-input-wrap___3fIh1{position:absolute;left:0;top:80%;bottom:0;right:0;background-color:#f7f7f7}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7{height:calc(100% - 25px);width:100%;resize:none;border:none;background-color:transparent;padding:10px}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7:focus,.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-input___2fNR7:hover{outline:none;box-shadow:none}.chat-box___36Ffp .chat-input-wrap___3fIh1 .chat-button___3FMsW{float:right;margin-right:4px}.chat-box___36Ffp .chat-message___hIeE5{padding:10px;overflow:hidden}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content___18ZG9{padding:5px 10px;position:relative;cursor:pointer;display:table-cell;max-width:60%;table-layout:fixed;word-wrap:break-word}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj{color:#919191;background:#e9e9e9;border-color:#e9e9e9;float:left;margin-left:10px;border-radius:0 10px 0 0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66{color:#00a2ae;background:#cfedf0;border-color:#cfedf0;float:right;margin-right:10px;border-radius:10px 0 0 0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:before,.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:before{z-index:11;position:absolute;width:0;height:0;bottom:0;border:10px solid transparent;content:""}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:before{left:-10px;border-bottom-color:#e9e9e9}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:before{right:-10px;border-bottom-color:#cfedf0}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:hover{background-color:hsla(0,0%,91%,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-left___1nJpj:hover:before{border-bottom-color:hsla(0,0%,91%,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:hover{background-color:rgba(207,237,240,.8)}.chat-box___36Ffp .chat-message___hIeE5 .chat-message-content-right___18Y66:hover:before{border-bottom-color:rgba(207,237,240,.8)}',""]),t.locals={"chat-box":"chat-box___36Ffp","chat-title":"chat-title___vffIm","chat-panel":"chat-panel___2UOJC","chat-input-wrap":"chat-input-wrap___3fIh1","chat-input":"chat-input___2fNR7","chat-button":"chat-button___3FMsW","chat-message":"chat-message___hIeE5","chat-message-content":"chat-message-content___18ZG9","chat-message-content-left":"chat-message-content-left___1nJpj","chat-message-content-right":"chat-message-content-right___18Y66"}},257:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,'.side-bar___pyzdK{padding:30px 0;width:100%;height:100%;background-color:#f7f7f7;border:1px solid hsla(0,0%,91%,.8);list-style:none}.side-bar-item___3y7Sh{cursor:pointer;text-indent:2em;padding:5px;position:relative;background:transparent}.side-bar-item___3y7Sh .item-content___2Dhao{position:relative;z-index:11;color:#919191}.side-bar___pyzdK .active___24oVN{position:relative;text-indent:2em;padding:5px;background:-webkit-linear-gradient(left,#fff 10px,transparent);background:linear-gradient(90deg,#fff 10px,transparent)}.side-bar___pyzdK .active___24oVN .item-content___2Dhao{color:#00a2ae}.side-bar___pyzdK .active___24oVN:before{z-index:10;content:"";position:absolute;top:0;bottom:0;left:0;width:6px;background:#00a2ae;opacity:.5}',""]),t.locals={"side-bar":"side-bar___pyzdK","side-bar-item":"side-bar-item___3y7Sh","item-content":"item-content___2Dhao",active:"active___24oVN"}},258:function(e,t,a){t=e.exports=a(70)(),t.push([e.id,".vertical-projection___3IWwX{box-shadow:0 0 20px hsla(0,0%,80%,.8)}.app-home___3d9MN{background-color:#fff}",""]),t.locals={"vertical-projection":"vertical-projection___3IWwX","app-home":"app-home___3d9MN"}},281:function(e,t,a){var n=a(255);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},283:function(e,t,a){var n=a(257);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},285:function(e,t,a){var n=a(258);"string"==typeof n&&(n=[[e.id,n,""]]);a(69)(n,{});n.locals&&(e.exports=n.locals)},509:function(e,t,a){"use strict";a(23),a(97)},524:509,567:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=(a(141),a(140)),l=n(o),s=(a(220),a(219)),r=n(s),c=a(90),i=n(c),d=a(13),f=n(d),_=a(67),u=n(_),h=a(16),p=n(h),m=a(15),g=n(m),b=a(14),x=n(b),v=a(1),y=n(v),E=a(281),k=n(E),w=a(10),N=n(w),I=a(40),C=n(I),F=a(19),M=n(F),T=function(e){var t,a=e.className,n=e.onChangeHandle,o=e.sendHandle,l=e.children,s=e.text,r=e.title,c=e.isAnimate,i=void 0===c||c,d=(0,N.default)((t={},(0,x.default)(t,a,a||!1),(0,x.default)(t,k.default["chat-box"],!0),t));return y.default.createElement("div",{className:d},y.default.createElement(j,null,r),y.default.createElement(H,{isAnimate:i},l),y.default.createElement(S,{onChangeHandle:n,sendHandle:o,value:s}))},P=y.default.PropTypes;T.propTypes={className:P.string,isAnimate:P.bool,onChangeHandle:P.func,sendHandle:P.func,text:P.string,title:P.oneOfType([P.string,P.node,P.element,P.number])};var j=function(e){var t=e.children,a=(0,N.default)((0,x.default)({},k.default["chat-title"],!0));return y.default.createElement("div",{className:a},t)},H=function(e){function t(e){(0,f.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.componentDidMount=function(){a.scrollChatPanelToBottom()},a.componentDidUpdate=function(){a.scrollChatPanelToBottom()},a.scrollChatPanelToBottom=function(){var e=M.default.findDOMNode(a.refs.chatPanel);setTimeout(function(){e.scrollTop=e.scrollHeight},0)},a.getNextMessageType=function(){var e=a.props.children;return 0==e.length?"right":e[e.length-1].props.type||"left"},a.chatPanel=null,a}return(0,g.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=(0,N.default)((0,x.default)({},k.default["chat-panel"],!0)),t=this.props.isAnimate;return t?y.default.createElement(C.default,{className:e,type:this.getNextMessageType(),component:"div",ref:"chatPanel"},this.props.children):y.default.createElement("div",{className:e,type:this.getNextMessageType(),ref:"chatPanel"},this.props.children)}}]),t}(y.default.Component),O=function(e){function t(e){return(0,f.default)(this,t),(0,p.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,g.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e,t=this.props,a=t.type,n=void 0===a?"left":a,o=t.children,l=(0,N.default)((0,x.default)({},k.default["chat-message"],!0)),s=(0,N.default)((e={},(0,x.default)(e,k.default["chat-message-content"],!0),(0,x.default)(e,k.default["chat-message-content-right"],"right"==n),(0,x.default)(e,k.default["chat-message-content-left"],"left"==n),e));return y.default.createElement("div",{className:l},y.default.createElement("p",{className:s},o," "))}}]),t}(y.default.Component),S=function(e){var t=e.onChangeHandle,a=e.sendHandle,n=e.value,o=(0,N.default)((0,x.default)({},k.default["chat-input-wrap"],!0));return y.default.createElement("div",{className:o},y.default.createElement(r.default,{type:"textarea",value:n,onChange:t,className:k.default["chat-input"],onPressEnter:a}),y.default.createElement(l.default,{className:k.default["chat-button"],onClick:a,size:"small"},"发送"))};T.ChatMessage=O,t.default=T,e.exports=t.default},569:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(14),l=n(o),s=a(6),r=n(s),c=a(1),i=n(c),d=a(283),f=n(d),_=a(10),u=n(_),h=a(40),p=(n(h),a(19)),m=(n(p),function(e){var t=e.children,a=e.activeKey;return i.default.createElement("ul",{className:f.default["side-bar"]},t.map(function(e,t){var n=e.props;return a.indexOf(e.key)!=-1&&(n=(0,r.default)({},n,{isActive:!0})),i.default.createElement(b,(0,r.default)({},n,{key:e.key}))}))}),g=i.default.PropTypes;m.propTypes={activeKey:g.arrayOf(g.string)};var b=function(e){var t,a=e.children,n=e.isActive,o=(0,u.default)((t={},(0,l.default)(t,f.default.active,n),(0,l.default)(t,f.default["side-bar-item"],!0),t));return i.default.createElement("li",{className:o},i.default.createElement("span",{className:f.default["item-content"]},a))};m.Item=b,t.default=m,e.exports=t.default},574:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=(a(223),a(222)),l=n(o),s=(a(524),a(221)),r=n(s),c=(a(509),a(214)),i=n(c),d=(a(88),a(87)),f=n(d),_=a(143),u=n(_),h=a(90),p=n(h),m=a(13),g=n(m),b=a(67),x=n(b),v=a(16),y=n(v),E=a(15),k=n(E),w=a(1),N=n(w),I=a(71),C=(a(72),a(40)),F=n(C),M=a(285),T=n(M),P=a(567),j=n(P),H=a(569),O=n(H),S=a(242),z=j.default.ChatMessage,J=O.default.Item,D=function(e){function t(e){(0,g.default)(this,t);var a=(0,y.default)(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.componentDidMount=function(){a.linkToSocket()},a.componentWillUnmount=function(){a.socket.onclose=null,a.closeLink()},a.componentWillReceiveProps=function(e){},a.messageOnChange=function(e){a.setState({text:e.target.value})},a.sendMessage=function(e){var t=a.state,n=t.text,o=t.messages;""!=n&&(o.push({content:n,type:"right"}),a.socket.send((0,u.default)({operaCode:2,content:n})),setTimeout(function(){a.setState({text:"",messages:o})},0))},a.linkToSocket=function(){var e=new WebSocket(S.socketHost);a.socket=e;try{e.onopen=function(t){var n=a.props.log.loginData.userId;e.send((0,u.default)({operaCode:1,userId:n})),a.setState({isConnecting:!0}),f.default.info("连接成功",3)},e.onmessage=function(e){if("string"==typeof e.data){var t=a.state.messages,n=JSON.parse(e.data);3==n.responseCode&&(t.push({content:n.content,type:"left"}),a.setState({messages:t}))}else f.default.info("非文本消息",3)},e.onclose=function(){a.setState({isConnecting:!1}),f.default.warn("连接已关闭",3)}}catch(e){f.default.error(e,3)}window.addEventListener?window.addEventListener("beforeunload",a.closeLink):window.attachEvent("onbeforeunload",a.closeLink)},a.closeLink=function(){var e=a.socket;try{e.close(),e=null}catch(e){new Error(e)}},a.state={text:"",isConnecting:!1,messages:[]},a}return(0,k.default)(t,e),(0,x.default)(t,[{key:"render",value:function(){var e=this.state,t=e.messages,a=(e.isConnecting,this.props.log.loginData.addressList),n=this.props.loading,o=void 0!==n&&n,s=a[0];return console.info(a,o),N.default.createElement(F.default,{duration:800,animConfig:{opacity:[1,0],translateY:[0,100]}},N.default.createElement("div",{className:T.default["app-home"],key:"home"},N.default.createElement(l.default,{spinning:o},N.default.createElement(r.default,{style:{width:"500px"},className:T.default["vertical-projection"]},N.default.createElement(i.default,{span:6,style:{height:"500px"}},N.default.createElement(O.default,{activeKey:["address"+s.userId]},a.map(function(e){return N.default.createElement(J,{key:"address"+e.userId},e.userName)}))),N.default.createElement(i.default,{span:18,style:{height:"500px"}},N.default.createElement(j.default,{onChangeHandle:this.messageOnChange,sendHandle:this.sendMessage,text:this.state.text,title:N.default.createElement("p",{style:{textAlign:"center"}},"Chat with "+(s?s.userName:"= ="))},t.map(function(e,t){return N.default.createElement(z,{type:e.type,key:"message"+t},e.content)})))))))}}]),t}(N.default.Component),Y=function(e){var t=e.log;e.message;return{loading:e.loading.models.log,log:t,message:f.default}};t.default=(0,I.connect)(Y)(D),e.exports=t.default}});